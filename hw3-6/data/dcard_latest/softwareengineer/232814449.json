{"id":232814449,"title":"#分享 PostgreSQL 如何估算 HashAggregate 的 Return Rows ，以及低估的後果","content":"http://i.imgur.com/O0EYkx8.jpg\n\n\n哈囉 大家好～～ 我是後端工程師端端，第一次來這邊發文大家請多多指教 🙏\n\n若大家有在寫網頁後端或是資料處理，不管是碰 PHP、Ruby、Python、NodeJS 還是其他各種程式語言，多多少少都有碰到資料庫吧～～～\n\n大家可能也都聽過或是碰過像是 MySQL 或 PostgreSQL，這些都是熱門的開源 SQL 資料庫。SQL 資料庫的特點之一就是開發者是使用已經抽象好的 SQL 語法來跟資料庫互動了，透過這層抽象讓資料庫會有機會透過各種方法找出它覺得最好的方式來滿足 SQL 語法的陳述。\n\n這所謂各種方法，當然不同的資料庫甚至同資料庫不同版本都有不同的方法啦。不過通常它們是有一個優化器自動的去嘗試預估它們能力範圍內的各種執行方案所花費的代價，最後才挑一個預估代價最小的方案去執行。在這種模式下，這個優化器的能力就相當重要啦。\n\n有些資料庫比較開放，讓開發者可以在 SQL 上就客製化這個優化器的行為；但有些資料庫，例如 PostgreSQL，開發者就很難在 SQL 上就控制它的優化器。雖然大部分時候開發者都不用擔心優化器不夠優秀，但其實它錯估的案例也不是說真的就很少見😅\n\n因此作為後端開發者若知道怎麼這種情況該怎麼處理是可以大大加分的！今天就跟大家分享一個我同事在 PostgreSQL 碰到的案例，希望對有興趣的人有幫助～～\n\nMedium 版：\nhttps://medium.com/pgsql-tw/postgresql-%E5%A6%82%E4%BD%95%E4%BC%B0%E7%AE%97-hashaggregate-%E7%9A%84-return-rows-%E4%BB%A5%E5%8F%8A%E4%BD%8E%E4%BC%B0%E7%9A%84%E5%BE%8C%E6%9E%9C-cc06719641da\n\n因為內文有些原始碼跟跟流程，為了閱讀性就直接放 Medium 連結了\n喜歡的話就請按讚訂閱分享 🙏","excerpt":"哈囉 大家好～～ 我是後端工程師端端，第一次來這邊發文大家請多多指教，若大家有在寫網頁後端或是資料處理，不管是碰 PHP、Ruby、Python、NodeJS 還是其他各種程式語言，多多少少都有碰到資","anonymousSchool":false,"anonymousDepartment":false,"pinned":false,"forumId":"a6dc1b6b-0aca-4004-86c8-3af6cdbfad23","replyId":null,"createdAt":"2020-01-02T18:48:29.540Z","updatedAt":"2020-01-02T18:48:29.540Z","commentCount":3,"likeCount":12,"tags":[],"topics":["資料庫","後端","PostgreSQL","SQL","軟體"],"supportedReactions":null,"withNickname":true,"reportReason":"","hiddenByAuthor":false,"meta":{"layout":"classic"},"forumName":"軟體工程師","forumAlias":"softwareengineer","school":"端端","department":"ruian","replyTitle":null,"gender":"M","personaSubscriptable":null,"reactions":[{"id":"286f599c-f86a-4932-82f0-f5a06f1eca03","count":12}],"hidden":false,"customStyle":null,"isSuspiciousAccount":false,"layout":"classic","withImages":true,"withVideos":false,"media":[{"url":"http://i.imgur.com/O0EYkx8.jpg"}],"reportReasonText":"","mediaMeta":[{"id":"27b37426-fc6b-4da4-aa77-8663e8d63103","url":"https://i.imgur.com/O0EYkx8l.jpg","normalizedUrl":"https://i.imgur.com/O0EYkx8l.jpg","thumbnail":"https://i.imgur.com/O0EYkx8l.jpg","type":"image/thumbnail","tags":["ANNOTATED"],"createdAt":"2020-01-02T18:48:29.540Z","updatedAt":"2020-01-02T18:48:29.540Z"},{"id":"27b37426-fc6b-4da4-aa77-8663e8d63103","url":"http://i.imgur.com/O0EYkx8.jpg","normalizedUrl":"https://imgur.com/O0EYkx8","thumbnail":"https://i.imgur.com/O0EYkx8l.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2020-01-02T18:48:29.540Z","updatedAt":"2020-01-02T18:48:29.540Z"}],"postAvatar":""}