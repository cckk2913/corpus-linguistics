{"id":232727707,"title":"#分享 Excel時間資料處理","content":"目前已開放hackmd的協作功能\n若有興趣或是覺得需要補充的都可以前往編輯\n建議由HackMD觀看本文\nhttps://hackmd.io/@LHB-0222/ExcelDate\n \n-----------目錄------------\nExcel_時間資料處理\nExcel時間基礎\n     Excel的日期序列\n     Excel的時間序列\n時間的輸入\n    取得系統時間\n時間的加減\n星期的判斷\n計算實際工作天數\n-----------------------------\n更多Office相關文章以整理收錄至\nhttps://coggle.it/diagram/W4FNtodcxln_KJa2/t/office-%E6%8A%80%E8%83%BD%E6%A8%B9 \n大家可以參考看看若每項功能皆會使用應該可以算是熟練Office了\n \n有疑問想討論的都歡迎於下方留言\n\n喜歡的幫我分享給所有的朋友 \\o/\n\n有所錯誤歡迎指教\n\n************本文****************\n\n前幾天完成了R語言中的時間處理\n\n今天來講講Excel中的時間格式\n\n相比於R語言Excel中的時間格式更加的簡單使用\n\n相對來說也有更多侷限性\n#  Excel時間基礎\n\n## Excel的日期序列\nExcel的日期是由從1900年01月01日開始為數字1==每日遞增1==至9999年12月31日2958465為止\n\n## Excel的時間序列\n時間上則為00:00:00至23:59:59，可以0~0.99998426代表\n計算方式可以理解為1天為數字1\n而一天包含24小時等於1400分鐘等於86400秒\n則一秒就是1/24/60/60=1.15741E-05\n若要查看時間所代表的序列值將格式選為數值即可\n\nhttp://i.imgur.com/E9ZkbaB.gif\n\n\n# 時間的輸入\n\n日期最簡單的輸入方式就是以斜線`/`與減號`-`分隔\n\nyyyy/mm/dd\nyyyy-mm-dd\n\n\n2019/12/19\n2019-12-19\n\nhttp://i.imgur.com/9nn5nCh.gif\n\n而時間上則是以冒號`:`將小時、分鐘、秒數作區隔\n可以使用24小時制或是12小時制(am、pm、AM、PM)\n\nhh:mm:ss\nhh:mm\nhh:mm am\nhh:mm pm\n\n\n原則上在安裝中文版的Excel中也可以辨識一些中文格式\n例如年、月、日、時、分、秒、上午、下午\n\nyyyy\"年\"mm\"月\"dd\"日\"\nhh\"時\"mm\"分\"ss\"秒\"\n上午/下午hh\"時\"mm\"分\"ss\"秒\"\n\nhttp://i.imgur.com/ABt4kuA.gif\n\n但像是輸入幾月幾號就沒用了\n簡單的判斷方式可以將日期作加減\n若是文字格式則無法計算\nhttp://i.imgur.com/hRshlDd.gif\n\n就需要利用較複雜的公式將字串中的日期提取出來做判斷\n\n\n=DATE(LEFT(B1,4),MID(B1,6,2),MID(B1,9,2))\n\n\nhttp://i.imgur.com/RXAyO9D.png\n\n## 取得系統時間\n傳回目前日期的序列值\n`TODAY()`回傳現在日期而`NOW()`則包含時間\n\n=TODAY()\n=NOW()\n\n\n可作為報表自動算剩餘時間的函數\n在每次開啟檔案時都會自動更新時間\n\nhttp://i.imgur.com/cX0ism6.gif\n\n\n# 時間的加減\n\n而在Execl中的日期計算與R並不相同\n\n在R與中時間加1則為一秒Excel中加1則為一天\n\n所以若是需要增加一秒則須加上1天/24小時/60分/60秒(1.15741E-05)\n\nhttp://i.imgur.com/Hdd52xS.png\n\n像下面的案例假設若是要計算所經過的時間來算加班時數的話\n\n相減後會得到一個奇怪的答案==上午 04:55:00==\nhttp://i.imgur.com/1osGsze.gif\n\n這是因為Excel的顯示格式上的問題\n\n只需要將格式自訂成`h:mm`即可\n\n若是需要精準到秒數只需要修改成`h:mm:ss`即可\n\nhttp://i.imgur.com/vEemtck.gif\n\n若是要計算日期也是以相同方式進行修改\n\n簡單的日期相減差幾天可以將格式轉為通用格式即可\n\n若是想算年資幾年就需要將格式改成`y/m/d`\n\nhttp://i.imgur.com/lYzEq5p.gif\n\n上述更改格式方式也可以使用`TEXT()`函數來達到相同的結果\n\n\n=TEXT(您要設定格式的值, \"您要套用的格式代碼)\n\n=TEXT(x-y,\"y/m/d\")\n=TEXT(x-y,\"h:mm:ss\")\n\nhttp://i.imgur.com/n10AwOc.png\n\n搭配`TODAY()`可以用於自動計算年資等資料\n\n# 星期的判斷\n\n在Excel中也提供了幾個很實用的函數\n\n例如`WEEKDAY(serial_number[return_type])`\nReturn_type   這決定傳回值的類型\n| Return_type | 傳回的數字 |\n|---|---|\n| 1 或省略 | 數字 1 (星期日) 到 7 (星期六)。與舊版 Microsoft Excel 的性質相同 |\n| 2 | 數字 1 (星期一) 到 7 (星期日) |\n| 3 | 數字 0 (星期一) 到 6 (星期六) |\n| 11 | 數字 1 (星期一) 到 7 (星期日) |\n| 12 | 數字 1 (星期二) 到 7 (星期一) |\n| 13 | 數字 1 (星期三) 到 7 (星期二) |\n| 14 | 數字 1 (星期四) 到 7 (星期三) |\n| 15 | 數字 1 (星期五) 到 7 (星期四) |\n| 16 | 數字 1 (星期六) 到 7 (星期五) |\n| 17 | 數字 1 (星期日) 到 7 (星期六) |\n\nhttp://i.imgur.com/kHY2Alc.png\n\n或是也可以修改格式顯示為`星期X`或是`週X`\n\nhttp://i.imgur.com/IOaDzQW.gif\n\n# 計算實際工作天數\n\n\n=NETWORKDAYS.INTL(start_date, end_date, [weekend], [holidays])\n\n==Start_date and end_date==  這是要計算差距的日期\nStart_date 可以早於、等於或晚於 end_date\n==Weekend==  這會指出 start_date 和 end_date 之間\n屬於週末且不包含在所有工作日數中的日子Weekend 是指定何時是週末的數字或字串\n==holidays== 這是要從工作日行事曆排除的一組選擇性的一個或多個日期\n可用於扣除中間國定假日\n\n| Weekend 數字 | 週末日         |\n| ------------ | -------------- |\n| 1 或省略     | 星期六、星期日 |\n| 2            | 星期日、星期一 |\n| 3            | 星期一、星期二 |\n| 4            | 星期二、星期三 |\n| 5            | 星期三、星期四 |\n| 6            | 星期四、星期五 |\n| 7            | 星期五、星期六 |\n| 11           | 僅星期日       |\n| 12           | 僅星期一       |\n| 13           | 僅星期二       |\n| 14           | 僅星期三       |\n| 15           | 僅星期四       |\n| 16           | 僅星期五       |\n| 17           | 僅星期六       |\nWeekend 字串值長度為七個字元，且字串中每個字元會代表一週內的一天，從星期一開始\n1代表非工作日， 0代表 workday。 字串中僅允許字元 1 和 0。 使用 1111111 一律會傳回 0。\n例如，0000011 代表週末為星期六和星期日。\n\nhttp://i.imgur.com/4obFLxK.png\n\nhttp://i.imgur.com/iiu6eE9.gif\n\n最後補充幾個可能會用到的函數\n`EOMONTH(start_date, months)` 傳回在 start_date 之前或之後所指定之月份數之當月最後一天的序列值\n`WORKDAY.INTL(start_date, days, [weekend], [holidays])` 使用自訂 weekend 參數傳回指定工作日數之前或之後日期的序列值","excerpt":"目前已開放hackmd的協作功能，若有興趣或是覺得需要補充的都可以前往編輯，建議由HackMD觀看本文，-----------目錄------------，Excel_時間資料處理，Excel時間基礎","anonymousSchool":false,"anonymousDepartment":false,"pinned":false,"forumId":"577f29b9-ef96-4e05-9e79-55e2a7d6e3db","replyId":null,"createdAt":"2019-12-20T15:34:35.266Z","updatedAt":"2019-12-21T02:15:36.264Z","commentCount":2,"likeCount":9,"tags":[],"topics":["時間","資料","Excel","教學"],"supportedReactions":null,"withNickname":true,"reportReason":"","hiddenByAuthor":false,"meta":{"layout":"classic"},"forumName":"App","forumAlias":"app","school":"阿好伯","department":"a_hao_bo","replyTitle":null,"gender":"M","personaSubscriptable":true,"reactions":[{"id":"286f599c-f86a-4932-82f0-f5a06f1eca03","count":9}],"hidden":false,"customStyle":null,"isSuspiciousAccount":false,"layout":"classic","withImages":true,"withVideos":false,"media":[{"url":"http://i.imgur.com/RXAyO9D.png"},{"url":"http://i.imgur.com/Hdd52xS.png"},{"url":"http://i.imgur.com/n10AwOc.png"},{"url":"http://i.imgur.com/kHY2Alc.png"},{"url":"http://i.imgur.com/4obFLxK.png"}],"reportReasonText":"","mediaMeta":[{"id":"5221e1dd-77df-49b5-93c3-69a8e8e261e5","url":"https://i.imgur.com/E9ZkbaBl.jpg","normalizedUrl":"https://i.imgur.com/E9ZkbaBl.jpg","thumbnail":"https://i.imgur.com/E9ZkbaBl.jpg","type":"image/thumbnail","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"5221e1dd-77df-49b5-93c3-69a8e8e261e5","url":"http://i.imgur.com/E9ZkbaB.gif","normalizedUrl":"https://imgur.com/E9ZkbaB","thumbnail":"https://i.imgur.com/E9ZkbaBl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"b6b5ae69-fd23-4157-819a-74bb70c7f98b","url":"http://i.imgur.com/9nn5nCh.gif","normalizedUrl":"https://imgur.com/9nn5nCh","thumbnail":"https://i.imgur.com/9nn5nChl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"d63301dd-5265-4018-a1d7-68216cf0dca1","url":"http://i.imgur.com/ABt4kuA.gif","normalizedUrl":"https://imgur.com/ABt4kuA","thumbnail":"https://i.imgur.com/ABt4kuAl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"91519bd4-2fea-4af5-aff1-ef7f44fd4272","url":"http://i.imgur.com/hRshlDd.gif","normalizedUrl":"https://imgur.com/hRshlDd","thumbnail":"https://i.imgur.com/hRshlDdl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"27e90a12-1bfe-44c9-846e-0af30562debf","url":"http://i.imgur.com/RXAyO9D.png","normalizedUrl":"https://imgur.com/RXAyO9D","thumbnail":"https://i.imgur.com/RXAyO9Dl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"682aaefe-64bc-4627-97cd-2a8d43b49b5b","url":"http://i.imgur.com/cX0ism6.gif","normalizedUrl":"https://imgur.com/cX0ism6","thumbnail":"https://i.imgur.com/cX0ism6l.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"d7d5492e-1531-409c-b243-6106fc368877","url":"http://i.imgur.com/Hdd52xS.png","normalizedUrl":"https://imgur.com/Hdd52xS","thumbnail":"https://i.imgur.com/Hdd52xSl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"59755c4e-b396-4da5-ae31-9b9a743765a3","url":"http://i.imgur.com/1osGsze.gif","normalizedUrl":"https://imgur.com/1osGsze","thumbnail":"https://i.imgur.com/1osGszel.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"700a0d98-1eea-429b-b3d8-04682a8ca01e","url":"http://i.imgur.com/vEemtck.gif","normalizedUrl":"https://imgur.com/vEemtck","thumbnail":"https://i.imgur.com/vEemtckl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:36:52.356Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"9e16f3ff-3037-4587-9756-ab9d856cb497","url":"http://i.imgur.com/lYzEq5p.gif","normalizedUrl":"https://imgur.com/lYzEq5p","thumbnail":"https://i.imgur.com/lYzEq5pl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"d38b1199-c78b-45a0-9cbc-e0365c69ec6d","url":"http://i.imgur.com/n10AwOc.png","normalizedUrl":"https://imgur.com/n10AwOc","thumbnail":"https://i.imgur.com/n10AwOcl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"a1b217a2-e807-4257-ab05-0b90d34d58db","url":"http://i.imgur.com/kHY2Alc.png","normalizedUrl":"https://imgur.com/kHY2Alc","thumbnail":"https://i.imgur.com/kHY2Alcl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"59464882-43b5-4a05-97f7-60a85fc46a1b","url":"http://i.imgur.com/IOaDzQW.gif","normalizedUrl":"https://imgur.com/IOaDzQW","thumbnail":"https://i.imgur.com/IOaDzQWl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"c64d4e89-2b0a-46cc-87d4-7f1350e83946","url":"http://i.imgur.com/4obFLxK.png","normalizedUrl":"https://imgur.com/4obFLxK","thumbnail":"https://i.imgur.com/4obFLxKl.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"},{"id":"7526339e-60e9-4b09-95de-55fa6ed94fc2","url":"http://i.imgur.com/iiu6eE9.gif","normalizedUrl":"https://imgur.com/iiu6eE9","thumbnail":"https://i.imgur.com/iiu6eE9l.jpg","type":"image/imgur","tags":["ANNOTATED"],"createdAt":"2019-12-20T15:35:36.554Z","updatedAt":"2019-12-21T02:15:36.264Z"}],"postAvatar":""}